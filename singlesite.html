<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="style.css">

    <header id="side_menu">
        <nav>
            <div id="menu_billede">
                <a href="index.html">
                    <img src="images/KOGA_LYB_WHITE.svg" alt="logo_profil"></a>
            </div>
            <div id="menuknap">☰</div>
            <ul id="menu" class="hidden">
                <li><a href="cykler.html">cykler</a></li>
                <li><a href="blog.html">blog</a></li>
                <li><a href="om_os.html">om os</a></li>
                <li><a href="kontakt.html">kontakt</a></li>
            </ul>
        </nav>
    </header>
</head>

<body>
    <!--Filterknapperne der inddeler de forskellige møbler-->
    <nav class="filter_alle">
        <button class="filter valgt" data-kategori="alle">Alle</button>
    </nav>
    <nav>
        <div class="filter_cykler">
            <button class="filter" data-kategori="E-Bike">E-Bike</button>
            <button class="filter" data-kategori="Race">Race</button>
            <button class="filter" data-kategori="City Tour">City Tour</button>
            <button class="filter" data-kategori="Trekking">Trekking</button>
        </div>
    </nav>

    <main>
        <section class="data">
        </section>
    </main>

    <template>
        <article class="article_cykel cykelside">
            <h2 class="navn"></h2>
            <div class="kort"></div>
            <p class="pris"></p>
            <img class="front_billede" src="">
        </article>
    </template>

    <footer id="footer">
        <div class="sectionwrapper">
            <div class="col">
                <div class="top">
                    <h2>Kontakt</h2>
                    <div class="icons icon_flex">
                        <img src="icons/place.svg" alt="Location">
                        <div>
                            <p>Peter Bangsvej 18</p>
                            <p>2000 Frederiksberg</p>
                        </div>
                    </div>
                    <div class="icons icon_flex">
                        <img src="icons/call-answer.svg" alt="Location">
                        <p class="align">+45 38 86 43 25</p>
                    </div>
                    <div class="icons icon_flex">
                        <img src="icons/email.svg" alt="Location">
                        <p class="align">info@kogacenter.dk</p>
                    </div>
                    <p></p>
                </div>
            </div>
            <div class="col">
                <div class="top">
                    <h2>KOGA</h2>
                    <div class="icons">
                        <img src="icons/facebook-logo.svg" alt="facebook">
                        <img src="icons/instagram.svg" alt="instagram">
                        <img src="icons/twitter.svg" alt="instagram">
                        <img src="icons/youtube.svg" alt="instagram">
                    </div>

                </div>
            </div>

            <div class="col">
                <div class="top">
                    <h2>Andet info</h2>
                    <p></p>
                </div>
            </div>
        </div>
    </footer>


    <script>
        //"?per_page=100";" skal skrives efter linket. Ellers vises der kun 10, som er default
        const url = "https://uwei.eu/kea/2_semester/tema9/koga/wordpress/wp-json/wp/v2/cykler?per_page=100";
        let cykler = [];
        //"Alle" i filterfunktionen skal vises som udgangspunkt.
        let filterKategori = "alle";

        document.addEventListener("DOMContentLoaded", start);


        function start() {
            hentJson();
            console.log("sidenVises");

            document.querySelector("#menuknap").addEventListener("click", toggleMenu);
            addEventListenersToButtons();
        }


        /*  function toggleMenu() {
            console.log("toggleMenu");
            document.querySelector("#menu").classList.toggle("hidden");

            let erSkjult =
                document.querySelector("#menu").classList.contains("hidden");

            if (erSkjult == true) {
                document.querySelector("#menuknap").textContent = "☰";
            } else {
                document.querySelector("#menuknap").textContent = "X";
            }
        }

        function myFunction() {
            document.getElementById("myDropdown").classList.toggle("show");
        }

        // When the user scrolls the page, execute myFunction
        window.onscroll = function() {
            fastHeader()
        };

        // Get the header
        var header = document.getElementById("side_menu");

        // Get the offset position of the navbar
        var sticky = header.offsetTop;

        // Add the sticky class to the header when you reach its scroll position. Remove "sticky" when you leave the scroll position
        function fastHeader() {
            if (window.pageYOffset > sticky) {
                header.classList.add("sticky");
            } else {
                header.classList.remove("sticky");
            }
        }
*/

        async function hentJson() {
            const response = await fetch(url);
            console.log(response);
            cykler = await response.json();
            console.log(cykler);
            vis();
            addEventListenersToButtons();
        }

        function vis() {
            const skabelon = document.querySelector("template");
            const data = document.querySelector(".data");

            //containeren bliver tømt eller nulstillet.
            data.innerHTML = "";

            cykler.forEach(cykel => {
                    //console.log("loop okay");
                    if ((filterKategori == "alle" || filterKategori = cykel.kategori)) {
                        const klon = skabelon.cloneNode(true).content;
                        klon.querySelector(".navn").textContent = cykel.title.rendered;
                        klon.querySelector(".kort").textContent = cykel.kort;
                        klon.querySelector(".pris").textContent = cykel.pris;
                        klon.querySelector(".front_billede").src = cykel.front_billede.guid;
                        data.appendChild(klon);

                        data.lastElementChild.addEventListener("click", (() => {
                                window.location.href = "singlesite.html?id=" + cykel.id;
                            });
                        }
                    })
            }


            function addEventListenersToButtons() {
                //Hvis varer knapperne ".filter" bliver trykket på, bliver filtrering () kaldt.
                //Hvis pris knapperne ".filter-prisklasse" bliver trykket på, bliver filtreringPrisklasse () kaldt.
                document.querySelectorAll(".filter").forEach(elm => {
                    elm.addEventListener("click", filtrering);
                })
            }

            function filtrering() {
                filterKategori = this.dataset.kategori;
                //Hvis filteret er "alle", så skal ".valgt" class'en være tilføjet til alle.
                //Hvis filteret er et på sorteringsfilteret ".filter", bliver ".valgt" fjernet fra "alle" og sat på ".filter" istedet.
                document.querySelectorAll(".filter").forEach(elm => {
                    elm.classList.remove("valgt");
                });
                this.classList.add("valgt");

                //visVarer () kaldes.
                visVarer();
            }
    </script>

</body>

</html>
